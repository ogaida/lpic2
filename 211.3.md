---
title: 211.3 Mailbox-Zugriff verwalten  Gewichtung 2
---

# {{ page.title }}

## 211.3 Mailbox-Zugriff verwalten

Kandidaten sollten POP3- und IMAP-Daemons installieren und konfigurieren können.

**Hauptwissensgebiete:**
-   Konfiguration und Verwaltung von Dovecot IMAP und POP3
-   Grundlegende TLS-Konfiguration von Dovecot
-   Wissen um Courier

**Dies ist eine auszugsweise Liste der verwendeten Dateien, Begriffe und
Hilfsprogramme:**
-   /etc/dovecot/
-   dovecot.conf
-   doveconf
-   doveadm

### MAN-Pages

- [manpage von dovecot](./man/dovecot.html)
- [manpage von doveconf](./man/doveconf.html)
- [manpage von doveadm](./man/doveadm.html)

### Installation von dovecot auf Ubuntu

Die Installation ist [hier](https://wiki.ubuntuusers.de/Dovecot/) gut beschrieben. Hier nur das wichtigste:

```
apt install dovecot-core
# je nach Bedarf:
apt-get install dovecot-imapd dovecot-pop3d
```

Ports anschauen:

```
root@ubuntu:~# netstat -tulpn | grep dove
tcp        0      0 0.0.0.0:110             0.0.0.0:*               LISTEN      7476/dovecot
tcp        0      0 0.0.0.0:143             0.0.0.0:*               LISTEN      7476/dovecot
tcp        0      0 0.0.0.0:993             0.0.0.0:*               LISTEN      7476/dovecot
tcp        0      0 0.0.0.0:995             0.0.0.0:*               LISTEN      7476/dovecot
tcp6       0      0 :::110                  :::*                    LISTEN      7476/dovecot
tcp6       0      0 :::143                  :::*                    LISTEN      7476/dovecot
tcp6       0      0 :::993                  :::*                    LISTEN      7476/dovecot
tcp6       0      0 :::995                  :::*                    LISTEN      7476/dovecot
```

- Imap benötigt: 143 und 993
- Pop3 benötigt 110 und 995

### dovecot Konfiguration

Anzeigen der nicht default-Werte mit `doveconf -n`:

```
root@ubuntu:~# doveconf -n
# 2.2.33.2 (d6601f4ec): /etc/dovecot/dovecot.conf
# Pigeonhole version 0.4.21 (92477967)
# OS: Linux 4.15.0-51-generic x86_64 Ubuntu 18.04.3 LTS
mail_location = mbox:~/mail:INBOX=/var/mail/%u
mail_privileged_group = mail
namespace inbox {
  inbox = yes
  location =
  mailbox Drafts {
    special_use = \Drafts
  }
  mailbox Junk {
    special_use = \Junk
  }
  mailbox Sent {
    special_use = \Sent
  }
  mailbox "Sent Messages" {
    special_use = \Sent
  }
  mailbox Trash {
    special_use = \Trash
  }
  prefix =
}
passdb {
  driver = pam
}
protocols = " imap pop3"
ssl_cert = </etc/dovecot/private/dovecot.pem
ssl_client_ca_dir = /etc/ssl/certs
ssl_key =  # hidden, use -P to show it
userdb {
  driver = passwd
}
```

Alle Einstellungen kann man mit `doveconf -a` prüfen.

Ein wichtige Einstellung ist hier die userdb, die bei mir auf passwd steht.

Auf der manpage von dovecot (siehe auch [hier](./man/dovecot.html)) findet man Hinweise auf die Verzeichnisstruktur der Konfigfiles:

```
/etc/dovecot/dovecot.conf
       Dovecot's main configuration file.

/etc/dovecot/dovecot-ldap.conf.ext
       Dovecot's LDAP authdb/userdb module configuration file.

/etc/dovecot/dovecot-sql.conf.ext
       Dovecot's SQL authdb/userdb module configuration file.

/etc/dovecot/dovecot-dict-sql.conf.ext
       Dovecot's dict configuration with SQL-backend.

/etc/dovecot/conf.d/auth-*-conf.ext
       Configuration files of different authentication modules.

/etc/dovecot/conf.d/*.conf
       Configuration files of different services and settings.
```

Schauen wir genauer in die Datei `/etc/dovecot/conf.d/auth-system.conf.ext`

```
root@ubuntu:~# cat /etc/dovecot/conf.d/auth-system.conf.ext | grep -vP '^\s*(#.*|)$'
passdb {
  driver = pam
}
userdb {
  driver = passwd
}
```

temporär zum Testen SSL abschalten:

```
grep 'ssl =' /etc/dovecot/conf.d/10-ssl.conf
ssl = no
```

### Logfiles

Um zu schauen, wo was protokolliert wird, kann man den Befehl `doveadm log find` verwenden:

```
root@ubuntu:~# doveadm log find
Looking for log files from /var/log
Debug: /var/log/syslog
Debug: /var/log/mail.log
Info: /var/log/syslog
Info: /var/log/mail.log
Warning: /var/log/syslog
Warning: /var/log/mail.log
Error: /var/log/syslog
Error: /var/log/mail.err
Error: /var/log/mail.log
Fatal: /var/log/syslog
Fatal: /var/log/mail.err
Fatal: /var/log/mail.log
```

Hier die

[HOME](./)
