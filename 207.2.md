---
title: 207.2 Erstellen und Verwalten von DNS-Zonen Gewichtung 3
---

# {{ page.title }}

## 207.2 Erstellen und Verwalten von DNS-Zonen

### Prüfen der Konfigurationsfiles

#### `named-checkconf`

Das wichtigste zuerst. Ein Neustart oder Neuladen einer fehlerhaften Konfiguration kann den gesamten DNS-Server zum erliegen bringen. Deshalb immer vorher testen!

__die gesamte Konfiguration testen:__

dazu nimmt man das Kommando `named-checkconf` mit dem Paramter `-z`. Der zusätzlich alle eingebundenen Zonenfiles mit überprüft.

Siehe auch [__man named-checkconf__](./man/named-checkconf.html)

```
root@ubuntu:/etc/bind# named-checkconf -z && echo "===============>>>>>>>>>>>>>   Die Konfiguration ist OK!  <<<<<<<<<<<<<<<<<<================"
zone localhost/IN: loaded serial 2
zone 127.in-addr.arpa/IN: loaded serial 1
zone 0.in-addr.arpa/IN: loaded serial 1
zone 255.in-addr.arpa/IN: loaded serial 1
zone lpic2.test/IN: loaded serial 2019120801
zone 17.191.10.in-addr.arpa/IN: loaded serial 2018120801
zone 18.191.10.in-addr.arpa/IN: loaded serial 2018120801
===============>>>>>>>>>>>>>   Die Konfiguration ist OK!  <<<<<<<<<<<<<<<<<<================
```

Hier ist alles in Ordnung. Wie es mit einem Fehler aussieht, sieht man hier:

```
root@ubuntu:/etc/bind# named-checkconf -z && echo "===============>>>>>>>>>>>>>   Die Konfiguration ist OK!  <<<<<<<<<<<<<<<<<<================"
zone localhost/IN: loaded serial 2
zone 127.in-addr.arpa/IN: loaded serial 1
zone 0.in-addr.arpa/IN: loaded serial 1
zone 255.in-addr.arpa/IN: loaded serial 1
zone lpic2.test/IN: loaded serial 2019120801
zone 17.191.10.in-addr.arpa/IN: loaded serial 2018120801
dns_rdata_fromtext: /etc/bind/zones/db.18.191.10:7: near eol: unexpected end of input
zone 18.191.10.in-addr.arpa/IN: loading from master file /etc/bind/zones/db.18.191.10 failed: unexpected end of input
zone 18.191.10.in-addr.arpa/IN: not loaded due to errors.
_default/18.191.10.in-addr.arpa/IN: unexpected end of input
```

Wenn man sich nur für den Fehler interessiert, dann lenkt man den `stdout` nach `/dev/null` um, dann kommt nur `stderr` zur Anzeige:

```
named-checkconf -z > /dev/null
_default/18.191.10.in-addr.arpa/IN: unexpected end of input
```

<script id="asciicast-klL3oXAF4GpLC8MD8820gpyyD" src="https://asciinema.org/a/klL3oXAF4GpLC8MD8820gpyyD.js" async>
</script>

#### `named-checkzone`

[__man named-checkzone__](./man/named-checkzone.html)

Ein Zonefile ohne Fehler bringt die folgende Ausgabe:

```
root@ubuntu:/etc/bind# named-checkzone db.18.191.10 /etc/bind/zones/db.18.191.10
zone db.18.191.10/IN: loaded serial 2018120801
OK
```

Nun kommentiere ich mal die `serial-number` aus und teste noch mal. Die Datei sieht dann so aus:

```
root@ubuntu:/etc/bind# cat /etc/bind/zones/db.18.191.10
$TTL      300 ; time-to-live - 5 min
@     IN    SOA   18.test. root.localhost. (
                 ; 2018120801 ; Serial
                  604800 ; Refresh (every 7 days)
                  86400 ; Retry (every 24h)
                  2419200 ; Expire (after 28 days)
                  604800 ) ; TTL Negativ Cache (7 days)
      IN      NS      ns1.lpic2.test.
9     IN    PTR   18.test.
```

```
root@ubuntu:/etc/bind# named-checkzone db.18.191.10 /etc/bind/zones/db.18.191.10
dns_rdata_fromtext: /etc/bind/zones/db.18.191.10:7: near eol: unexpected end of input
zone db.18.191.10/IN: loading from master file /etc/bind/zones/db.18.191.10 failed: unexpected end of input
zone db.18.191.10/IN: not loaded due to errors.
```

Hier wird auf Zeile 7 hingewiesen, das ist die Zeile in der die Konfiguration des SOA-Records abgeschlossen wird. Also sollte man dort den Fehler suchen. Ein Fehler der mir
gerne passiert, ich erstelle keine Mail-Adresse des Zonen-Verantwortlichen. In diesem Beispiel ist das die Angabe `root.localhost.` , das wird dann zu der Email `root@localhost`
übersetzt.

### Erstellen einer privaten Zone

Zum Testen erstelle ich eine Zone die nur von meinem DNS-Server aufgelöst wird. Das heißt, die Clients, die meine Zone auflösen wollen,
müssen diesen DNS-Server eingetragen haben.



[HOME](./)
